}
i01
setwd("~/Library/CloudStorage/OneDrive-個人用/Office/eTax/01_会計/01_①預貯金")
# files <- dir(	pattern = "^[:digit:]" ,ignore.case=T ) # NG ^ doesn't work
files <- dir(	pattern = "^[01]._" ,ignore.case=T )
files
for( f in files ) {
#  i01 <- i01 |> rbind( read.table( f ,header=T ,sep="\t" ) ) # invalid multibyte string 1
#  i01 <- i01 |> rbind( read.table( f ,header=T ,sep="\t" ,skip=2 ) )
message( f )
i01_nl <-
read.table( f
# read.csv( f ,header = F
# ,header=T # header \t row ","
,fileEncoding = "CP932" # : invalid multibyte string at '<82>݂<b8><82><d9> '
# line 1 did not have 8 elements
,sep=","
#,sep="[,\t]" # : invalid 'sep' value: must be one byte
#  ,skip=2
# row.names = F
)
if( f == files[1]){
i01 <- i01_nl
} else {
i01 <- i01 |> rbind( i01_nl )
}
}
for( f in files ) {
#  i01 <- i01 |> rbind( read.table( f ,header=T ,sep="\t" ) ) # invalid multibyte string 1
#  i01 <- i01 |> rbind( read.table( f ,header=T ,sep="\t" ,skip=2 ) )
message( f )
i01_nl <-
read.table( f
# read.csv( f ,header = F
# ,header=T # header \t row ","
,fileEncoding = "CP932" # : invalid multibyte string at '<82>݂<b8><82><d9> '
# line 1 did not have 8 elements
,sep=","
#,sep="[,\t]" # : invalid 'sep' value: must be one byte
#  ,skip=2
# row.names = F
)
if( f == files[1]){
i01 <- i01_nl
} else {
i01 <- i01 |> rbind( i01_nl )
}
}
i01 |> View()
read_sbi
setwd("~/Library/CloudStorage/OneDrive-個人用/Office/B_9900_ゆうちょ銀行")
#B_9900 <- read_bank( f="^2025.*.csv" ,p="^Fin")
B_9900 <- read_bank( f="^2025.*.csv" )
setwd("~/Library/CloudStorage/OneDrive-個人用/Office/eTax/01_会計/01_①預貯金")
# files <- dir(	pattern = "^[:digit:]" ,ignore.case=T ) # NG ^ doesn't work
files <- dir(	pattern = "^[01]._" ,ignore.case=T )
files
for( f in files ) {
message( f )
i01_nl <-
read.table( f
,fileEncoding = "CP932"
,sep=","
)
if( f == files[1]){
i01 <- i01_nl
} else {
i01 <- i01 |> rbind( i01_nl )
}
}
i01 |> View()
setwd("~/Library/CloudStorage/OneDrive-個人用/Office/B_0038_住信SBIネット銀行/01_代表口座")
# 代表口座は個別対応
#B_0038 <- read_bank( f="^2025.*代表口座.csv" ,p="^Fin")
B_0038 <- read_bank( f="^2025.*代表口座.csv")
# 代表口座は個別対応
#B_0038 <- read_bank( f="^2025.*代表口座.csv" ,p="^Fin")
B_0038 <- read_bank( f="^2025.*代表口座.csv")
setwd("~/Library/CloudStorage/OneDrive-個人用/Office/B_0038_住信SBIネット銀行/02_ハイブリッド預金")
#B_0038 <- read_bank( f="^2025.*.csv" ,p="^Fin") #
B_0038 <- read_bank( f="^2025.*.csv" )
setwd("~/Library/CloudStorage/OneDrive-個人用/Office/B_0038_住信SBIネット銀行/01_代表口座")
# 代表口座は個別対応
#B_0038 <- read_bank( f="^2025.*代表口座.csv" ,p="^Fin")
B_0038 <- read_bank( f="^2025.*代表口座.csv")
# 代表口座は個別対応
#B_0038 <- read_bank( f="^2025.*代表口座.csv" ,p="^Fin")
B_0038 <- read_bank( f="^2025.*代表口座.csv")
setwd("~/Library/CloudStorage/OneDrive-個人用/Office/B_0038_住信SBIネット銀行/03_デビットカード")
# デビットカード、分割対応
B_0038 <- read_bank( f="^2025.*.csv" )
setwd("~/Library/CloudStorage/OneDrive-個人用/Office/eTax/01_会計/01_①預貯金")
# files <- dir(	pattern = "^[:digit:]" ,ignore.case=T ) # NG ^ doesn't work
files <- dir(	pattern = "^[01]._" ,ignore.case=T )
for( f in files ) {
message( f )
i01_nl <-
read.table( f
,fileEncoding = "CP932"
,sep=","
)
if( f == files[1]){
i01 <- i01_nl
} else {
i01 <- i01 |> rbind( i01_nl )
}
}
i01 |> View()
setwd("~/Library/CloudStorage/OneDrive-個人用/Office/B_0988_SBI証券/05_先物")
# B_0998 <- read_bank( f="^ReciveGuaHistoryRefer2025" ,p="^Fin" ,cp="UTF-8")
B_0998 <- read_bank( f="^ReciveGuaHistoryRefer2025" ,p="^Fin_00" )
B_0998 <- read_bank( f="^ReciveGuaHistoryRefer2025" ,p="^Fin_01" )
B_0998 <- read_bank( f="^ReciveGuaHistoryRefer2025" ,p="^Fin_02" )
B_0998 <- read_bank( f="^ReciveGuaHistoryRefer2025" ,p="^Fin_03" )
B_0998 <- read_bank( f="^ReciveGuaHistoryRefer2025" ,p="^Fin_04" )
setwd("~/Library/CloudStorage/OneDrive-個人用/Office/B_0009_三井住友銀行")
setwd("~/Library/CloudStorage/OneDrive-個人用/Office/B_0009_三井住友銀行/01_普通預金ご利用明細")
B_0009 <- read_bank(f="^普通預金.*.csv$" ,cp="UTF-8" )
setwd("~/Library/CloudStorage/OneDrive-個人用/Office/eTax/01_会計/01_①預貯金")
# files <- dir(	pattern = "^[:digit:]" ,ignore.case=T ) # NG ^ doesn't work
files <- dir(	pattern = "^[01]._" ,ignore.case=T )
for( f in files ) {
message( f )
i01_nl <-
read.table( f
,fileEncoding = "CP932"
,sep=","
)
if( f == files[1]){
i01 <- i01_nl
} else {
i01 <- i01 |> rbind( i01_nl )
}
}
i01 |> View()
f <- i01.sheet( "2025-8-31" )
f
f <- i01.sheet( "2025-8-31" )
# f <- i01.sheet( "2025-8-31" ) # Nothing
f <- "HOI010_4.0_①預貯金等_csv"
Write_eTax( i01 ,f )　# HOI060_4.0_⑥有価証券
i01[,6] |> sum( na.rm = T )
i01[,6] |> as.integer() |> sum( na.rm = T )
i01[,6]
i01[,7]
i01[,7] |> sum( )
i01 |> View()
i01_1 <- i01[1]
i01_1
i01_1 <- i01[1,]
i01_1
i01_1 <- ""
i01_1
i01_1 <- i01[1,]
i01_1[1,] <- ""
i01_1
i01_1 <- i01[1,]
i01_1[1,] <- ""
i01_1[1,1] <- 6
i01_1[1,2] <-  1
i01_1[1,7] <-i01[,7] |> sum( )
i01_1[1,7]
Write_eTax( rbind( i01 ,i01_1 ) ,f )　# HOI010_4.0_①預貯金等
i01_1[1,1] <- 1
Write_eTax( rbind( i01 ,i01_1 ) ,f )　# HOI010_4.0_①預貯金等
# f <- i01.sheet( "2025-8-31" ) # Nothing
f <- "HOI010_4.0_①預貯金等"
f
Write_eTax( rbind( i01 ,i01_1 ) ,f )　# HOI010_4.0_①預貯金等
setwd("~/Library/CloudStorage/OneDrive-個人用/Office/B_0988_SBI証券/05_先物")
# B_0998 <- read_bank( f="^ReciveGuaHistoryRefer2025" ,p="^Fin" ,cp="UTF-8")
B_0998 <- read_bank( f="^ReciveGuaHistoryRefer2025" ,p="^Fin_00" )
B_0998 <- read_bank( f="^ReciveGuaHistoryRefer2025" ,p="^Fin_01" )
B_0998 <- read_bank( f="^ReciveGuaHistoryRefer2025" ,p="^Fin_02" )
B_0998 <- read_bank( f="^ReciveGuaHistoryRefer2025" ,p="^Fin_03" )
B_0998 <- read_bank( f="^ReciveGuaHistoryRefer2025" ,p="^Fin_04" )
setwd("~/Library/CloudStorage/OneDrive-個人用/Office/eTax/01_会計/01_①預貯金")
for( f in files ) {
message( f )
i01_nl <-
read.table( f
,fileEncoding = "CP932"
,sep=","
)
if( f == files[1]){
i01 <- i01_nl
} else {
i01 <- i01 |> rbind( i01_nl )
}
}
i01 |> View()
setwd("~/Library/CloudStorage/OneDrive-個人用/Office/B_0988_SBI証券/05_先物")
# B_0998 <- read_bank( f="^ReciveGuaHistoryRefer2025" ,p="^Fin" ,cp="UTF-8")
B_0998 <- read_bank( f="^ReciveGuaHistoryRefer2025" ,p="^Fin_00" )
B_0998 <- read_bank( f="^ReciveGuaHistoryRefer2025" ,p="^Fin_01" )
B_0998 <- read_bank( f="^ReciveGuaHistoryRefer2025" ,p="^Fin_02" )
B_0998 <- read_bank( f="^ReciveGuaHistoryRefer2025" ,p="^Fin_03" )
B_0998 <- read_bank( f="^ReciveGuaHistoryRefer2025" ,p="^Fin_04" )
setwd("~/Library/CloudStorage/OneDrive-個人用/Office/eTax/01_会計/01_①預貯金")
# files <- dir(	pattern = "^[:digit:]" ,ignore.case=T ) # NG ^ doesn't work
files <- dir(	pattern = "^[01]._" ,ignore.case=T )
files <- dir(	pattern = "B_0033.*_i01.csv$" ,ignore.case=T )
# files <- dir(	pattern = "^[:digit:]" ,ignore.case=T ) # NG ^ doesn't work
files <- dir(	pattern = "^[01]._" ,ignore.case=T )
for( f in files ) {
message( f )
i01_nl <-
read.table( f
,fileEncoding = "CP932"
,sep=","
)
if( f == files[1]){
i01 <- i01_nl
} else {
i01 <- i01 |> rbind( i01_nl )
}
}
# f <- i01.sheet( "2025-8-31" ) # Nothing
f <- "HOI010_4.0_①預貯金等"
i01_1 <- i01[1,]
i01_1[1,] <- ""
i01_1[1,1] <- 1
i01_1[1,2] <- 1
i01_1[1,7] <-i01[,7] |> sum( )
i01 |> View()
Write_eTax( rbind( i01 ,i01_1 ) ,f )　# HOI010_4.0_①預貯金等
i01_1
i01 |> View()
setwd("~/Library/CloudStorage/OneDrive-個人用/Office/B_0988_SBI証券/05_先物")
# B_0998 <- read_bank( f="^ReciveGuaHistoryRefer2025" ,p="^Fin" ,cp="UTF-8")
B_0998 <- read_bank( f="^ReciveGuaHistoryRefer2025" ,p="^Fin_00" )
B_0998 <- read_bank( f="^ReciveGuaHistoryRefer2025" ,p="^Fin_01" )
B_0998 <- read_bank( f="^ReciveGuaHistoryRefer2025" ,p="^Fin_02" )
B_0998 <- read_bank( f="^ReciveGuaHistoryRefer2025" ,p="^Fin_03" )
B_0998 <- read_bank( f="^ReciveGuaHistoryRefer2025" ,p="^Fin_04" )
setwd("~/Library/CloudStorage/OneDrive-個人用/Office/eTax/01_会計/01_①預貯金")
# files <- dir(	pattern = "^[:digit:]" ,ignore.case=T ) # NG ^ doesn't work
files <- dir(	pattern = "^[01]._" ,ignore.case=T )
for( f in files ) {
message( f )
i01_nl <-
read.table( f
,fileEncoding = "CP932"
,sep=","
)
if( f == files[1]){
i01 <- i01_nl
} else {
i01 <- i01 |> rbind( i01_nl )
}
}
i01 |> View()
# library(etaxtools)
# f <- i01.sheet( "2025-8-31" ) # Nothing
f <- "HOI010_4.0_①預貯金等"
i01_1 <- i01[1,]
i01_1[1,] <- ""
i01_1[1,1] <- 1
i01_1[1,2] <- 1
i01_1[1,7] <-i01[,7] |> sum( )
i01_1 |> View()
Write_eTax( rbind( i01 ,i01_1 ) ,f )　# HOI010_4.0_①預貯金等
setwd(choose.dir())
# install.packages( "openxlsx" )
library( openxlsx )
# 入力・標準フォーム
col_fs <-
# 一般商工業 HOT010_3.0_BS_10.csv
"https://www.e-tax.nta.go.jp/hojin/gimuka/csv_jyoho3/1/HOT010_3.0_BS_10.xlsx" |>
read.xlsx(startRow = 2) # |> colnames()
col_fs
col_fs |> View()
# 入力・標準フォーム
col_fs <-
# 一般商工業 HOT010_3.0_BS_10.csv
"https://www.e-tax.nta.go.jp/hojin/gimuka/csv_jyoho3/1/HOT010_3.0_BS_10.xlsx" |>
read.xlsx(startRow = 1) # |> colnames()
col_fs |> View()
v5 <- "10A100020" # 勘定科目コード  現金及び預金
i <- which(col_fs[,5] == v5)
i
v5
i <- which(col_fs[,5] == v5)
i
i <- which(col_fs$5 == v5)
i <- which(col_fs$"5" == v5)
i
fs <- subset( col_fs[i,] ,select=c("1","2","3","4","5"))
fs
fs <- subset( col_fs[i-2:i,] ,select=c("1","2","3","4","5"))
fs
i
h <- i - 2
fs <- subset( col_fs[h:i,] ,select=c("1","2","3","4","5"))
fs
fs <- subset( col_fs[(i-2):i,] ,select=c("1","2","3","4","5"))
fs
fs[3,2] <- i01_1[1,7]
fs
f <- paste0( "fs_" ,fs[i,5] ,"_" ,fs[i,2] )
f
f <- paste0( "fs_" ,fs[i,"5"] ,"_" ,fs[i,"2"] )
f
fs <- subset( col_fs[ i, ] ,select=c("1","2","3","4","5"))
fs
f <- paste0( "fs_" ,fs[1,5] ,"_" ,fs[1,2] )
f
f <- paste0( "fs_" ,fs[1,5] ,"_" ,fs[1,1] )
f
subset( col_fs[ (i-2):(i-1), ] ,select=c("1","2","3","4","5")) |>
rbind( fs )
fs <- subset( col_fs[ (i-2):(i-1), ] ,select=c("1","2","3","4","5")) |>
rbind( fs )
fs <- subset( col_fs[ i, ] ,select=c("1","2","3","4","5"))
fs[1,2] <- i01_1[1,7]
f <- paste0( "fs_" ,fs[1,5] ,"_" ,fs[1,1] )
fs <- subset( col_fs[ (i-2):(i-1), ] ,select=c("1","2","3","4","5")) |>
rbind( fs )
fs
getwd()
Write_eTax( fs ,f )
v5 <- "10A230030" # 勘定科目コード  投資有価証券
i <- which(col_fs$"5" == v5)
fs <- subset( col_fs[ i, ] ,select=c("1","2","3","4","5"))
fs[1,2] <- i01_1[1,7]
f <- paste0( "fs_" ,fs[1,5] ,"_" ,fs[1,1] )
f
i06_1[1 ,8]
fs[1,2] <- i06_1[1 ,8]
fs
fs <- subset( col_fs[ (i-2):(i-1), ] ,select=c("1","2","3","4","5")) |>
rbind( fs )
setwd("~/Library/CloudStorage/OneDrive-個人用/Office/eTax/01_会計/02_⑥有価証券")
Write_eTax( fs ,f )
#
v5 <- "10A000020" # 勘定科目コード  資産
i <- which(col_fs$"5" == v5)
fs <- subset( col_fs[ i, ] ,select=c("1","2","3","4","5"))
fs[1,2] <- i06_1[ 1 ,8 ] + i01_1[ 1 ,7 ]
f <- paste0( "fs_" ,fs[1,5] ,"_" ,fs[1,1] )
f
Write_eTax( fs ,f )
fs[1,2]
i06_1[ 1 ,8 ]
i01_1[ 1 ,7 ]
fs[1,2] <- i06_1[ 1 ,8 ] + as.integer( i01_1[ 1 ,7 ] ) # 改善要
fs[1,2]
Write_eTax( fs ,f )
setwd("~/Library/CloudStorage/OneDrive-個人用/Office/eTax/02_財務諸表")
# 入力・標準フォーム
BS_init <-
# 一般商工業 HOT010_3.0_BS_10.csv
"https://www.e-tax.nta.go.jp/hojin/gimuka/csv_jyoho3/1/HOT010_3.0_BS_10.xlsx" |>
read.xlsx(startRow = 1) # |> colnames()
BS_init |> View()
i <- which(col_fs$"5" == v5)
BS <- subset( col_fs[ i, ] ,select=c("1","2","3","4","5"))
v5 <- "10A000020" # 勘定科目コード  資産
i <- which(col_fs$"5" == v5)
BS <- subset( col_fs[ i, ] ,select=c("1","2","3","4","5"))
BS
BS_A <- subset( col_fs[ i, ] ,select=c("1","2","3","4","5"))
BS_A <- subset( col_fs[ i, ] ,select=c("1","2","3","4","5"))
BS_A
files <- dir(	pattern = "^BS_10.*.csv$" ,ignore.case=T )
files
for( f in files ) {
message( f )
BS_nl <-
read.table( f
,fileEncoding = "CP932"
,sep=","
)
if( f == files[1]){
BS <- BS_nl
} else {
BS <- BS |> rbind( BS_nl )
}
}
BS |> View()
files <- dir(	pattern = "^BS_10A.*.csv$" ,ignore.case=T )
files
for( f in files ) {
message( f )
BS_nl <-
read.table( f
,fileEncoding = "CP932"
,sep=","
)
if( f == files[1]){
BS <- BS_nl
} else {
BS <- BS |> rbind( BS_nl )
}
}
BS |> View()
for( f in files ) {
message( f )
BS_nl <-
read.table( f
,fileEncoding = "CP932"
,sep=","
,colClasses = c("character"
, "integer"
, "character"
, "character"
, "character"
)
)
if( f == files[1]){
BS <- BS_nl
} else {
BS <- BS |> rbind( BS_nl )
}
}
BS |> View()
for( f in files ) {
message( f )
BS_nl <-
read.table( f
,fileEncoding = "CP932"
,sep=","
,colClasses = c("character"
, "integer"
, "character"
, "character"
, "character"
)
)
if( f == files[1]){
BS <- BS_nl
} else {
BS <- BS |> rbind( BS_nl )
}
}
BS |> View()
BS
for( f in files ) {
message( f )
BS_nl <-
read.table( f
,fileEncoding = "CP932"
,sep=","
,tryLogical = F
#,colClasses = c("character"
#              , "integer"
#              , "character"
#              , "character"
#              , "character"
#          )
)
if( f == files[1]){
BS <- BS_nl
} else {
BS <- BS |> rbind( BS_nl )
}
}
BS |> View()
BS |> class()
BS |> sapply( class() )
BS[] |> sapply( class() )
BS[,] |> sapply( class() )
BS[,1:5] |> sapply( class() )
BS |> mode()
BS |> sapply( mode )
BS |> sapply( class ) # OK
i <- which(BS[2] |>is.integer())
i
i <- which(BS[,2] |>is.integer())
i
BS[,2] |>is.integer()
BS[,2] |>is.numeric()
BS_A[1,2] <- BS[,2] |>as.numeric() |> sum( na.rm = T )
BS[,2] |> as.integer()
BS_A[1,2] <- BS[,2] |> as.integer() |> sum( na.rm = T )
BS_A[1,2]
i <- BS[,2] |> sapply( is.integer )
i
i <- BS[2:,2] |> sapply( is.integer )
i <- BS[-1,2] |> sapply( is.integer )
i
i <- BS[-(1:4),2] |> sapply( is.integer )
i
i <- BS[,2] |> sapply( is.numeric )
i
BS_A[1,2] <- BS[,2] |> as.numeric() |> sum( na.rm = T )
BS_A[1,2]
i <- BS[,5] |> !is.na()
i <- BS[,5] |> is.na()
i
BS_A[1,2] <- BS[-i,2]  |> sum( na.rm = T )
BS_A[1,2] <- BS[-i,2] |> as.numeric() |> sum( na.rm = T )
BS[-i,2]
i
BS[!i,2]
BS_A[1,2] <- BS[ !i ,2] |> as.numeric() |> sum( na.rm = T )
BS_A[1,2]
BS_A
i <- which( BS_init$"5" == v5 )
BS_B <- subset( col_fs[ i, ] ,select=c("1","2","3","4","5"))
BS_B
v5
v5 <- "10B000020" # 勘定科目コード  負債
i <- which( BS_init$"5" == v5 )
BS_B <- subset( col_fs[ i, ] ,select=c("1","2","3","4","5"))
BS_B
#getwd()
files <- dir(	pattern = "^BS_10B.*.csv$" ,ignore.case=T )
files
BS_A
f <- "HOT010_3.0_BS"
f
