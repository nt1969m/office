#別表8_3_0.R
f <- b08.sheet()
f
Write_eTax( b08 ,f )
#2025-08-31
# sum( col  9(41) ) =          2,200,395     #col  9 受取配当等の額=  numeric
# sum( col 10(42) ) =                0     #col 10 益金算入=        logical
# sum( col 11(43) ) =          2,200,395     #col 11 益金不算入=      numeric
b08 |> View()
#2025-08-31
# sum( col  9(41) ) =          2,200,395     #col  9 受取配当等の額=  numeric
# sum( col 10(42) ) =                0     #col 10 益金算入=        logical
# sum( col 11(43) ) =          2,200,395     #col 11 益金不算入=      numeric
b08 |> View()
setwd("~/Library/CloudStorage/OneDrive-個人用/Office/eTax/02_財務諸表")
files <- dir(	pattern = "^SS_SS.*.csv$" ,ignore.case=T )
#files |> file.info()
#files |> file.mtime()
SS <- matrix(nrow=1,ncol=5)
for( f in files ) {
message( f ,"\t\t",f |> file.mtime() )
SS_nl <-
read.table( f
,fileEncoding = "CP932"
,sep=","
,tryLogical = F
)
SS <- SS |> rbind( SS_nl )
}
SS |> View()
i_SS <- which(SS[,5] == "SS2006") #SS:当期純利益
SS[ i_SS ,]
# i_PL <- which(PL[,5] == "SS2006") #PL:当期純利益
PL[i_net,]
SS[ i_SS,2 ] <- PL[i_net,2]
#
SS[ i_SS + 1 , ]
SS[ i_SS + 1 ,2 ] <-  SS[ i_SS - 1 ,2 ] |> as.integer() +
SS[ i_SS     ,2 ] |> as.integer()
SS |> View()
#
f <- paste0( "HOT010_3.0_SS" ,"_仮")
Write_eTax( SS ,f)
#files |> file.info()
#files |> file.mtime()
SS <- matrix(nrow=1,ncol=5)
for( f in files ) {
message( f ,"\t\t",f |> file.mtime() )
SS_nl <-
read.table( f
,fileEncoding = "CP932"
,sep=","
,tryLogical = F
)
SS <- SS |> rbind( SS_nl )
}
i_SS <- which(SS[,5] == "SS2006") #SS:当期純利益
SS[ i_SS ,]
# i_PL <- which(PL[,5] == "SS2006") #PL:当期純利益
PL[i_net,]
SS[ i_SS,2 ] <- PL[i_net,2]
#
SS[ i_SS + 1 , ]
SS[ i_SS + 1 ,2 ] <-  SS[ i_SS - 1 ,2 ] |> as.integer() +
SS[ i_SS     ,2 ] |> as.integer()
SS |> View()
#
f <- paste0( "HOT010_3.0_SS" ,"_仮")
Write_eTax( SS ,f)
#files |> file.info()
#files |> file.mtime()
SS <- matrix(nrow=1,ncol=5)
for( f in files ) {
message( f ,"\t\t",f |> file.mtime() )
SS_nl <-
read.table( f
,fileEncoding = "CP932"
,sep=","
,tryLogical = F
)
SS <- SS |> rbind( SS_nl )
}
SS |> View()
#files |> file.info()
#files |> file.mtime()
SS <- matrix(nrow=0,ncol=5)
for( f in files ) {
message( f ,"\t\t",f |> file.mtime() )
SS_nl <-
read.table( f
,fileEncoding = "CP932"
,sep=","
,tryLogical = F
)
SS <- SS |> rbind( SS_nl )
}
SS |> View()
i_SS <- which(SS[,5] == "SS2006") #SS:当期純利益
SS[ i_SS ,]
# i_PL <- which(PL[,5] == "SS2006") #PL:当期純利益
PL[i_net,]
SS[ i_SS,2 ] <- PL[i_net,2]
#
SS[ i_SS + 1 , ]
SS[ i_SS + 1 ,2 ] <-  SS[ i_SS - 1 ,2 ] |> as.integer() +
SS[ i_SS     ,2 ] |> as.integer()
SS |> View()
#
f <- paste0( "HOT010_3.0_SS" ,"_仮")
Write_eTax( SS ,f)
BS <- matrix( nrow=0 ,ncol=5 )
for( f in files ) {
message( f ,"\t\t" ,f |> file.mtime() )
BS_nl <- read.table( f
,fileEncoding = "CP932"
,sep=","
,tryLogical = F
)
BS <- BS |> rbind( BS_nl )
}
BS |> View()
files <- dir(	pattern = "^BS_10.*.csv$" ,ignore.case=T )
files
BS <- matrix( nrow=0 ,ncol=5 )
for( f in files ) {
message( f ,"\t\t" ,f |> file.mtime() )
BS_nl <- read.table( f
,fileEncoding = "CP932"
,sep=","
,tryLogical = F
)
BS <- BS |> rbind( BS_nl )
}
BS |> View()
i_A <- which(BS[,5] == "10A000020") #資産
i <- grep( "^10A[12]",BS[,5] )
BS[ i_A,2 ] <- BS[ i ,2] |> as.integer() |> sum( na.rm = T )
#
i_C <- which(BS[,5] == "10C130370") #繰越利益剰余金
BS[ i_C,  ]
BS[ i_C,2 ] <- SS[ i_SS + 1 ,2]     #SS:
#
i_C <- which(BS[,5] == "10C000030") #純資産
i <- grep( "^10C[12]",BS[,5] )
BS[ i_C,2 ] <- BS[ i ,2] |> as.numeric() |> sum( na.rm = T )
#
i_B <- which(BS[,5] == "10B000020") #負債
BS[ i_B ,2 ] <- BS[ i_A ,2 ] |> as.integer() -
BS[ i_C ,2 ] |> as.integer()
files <- dir(	pattern = "^BS_10.*.csv$" ,ignore.case=T )
BS <- matrix( nrow=0 ,ncol=5 )
for( f in files ) {
message( f ,"\t\t" ,f |> file.mtime() )
BS_nl <- read.table( f
,fileEncoding = "CP932"
,sep=","
,tryLogical = F
)
BS <- BS |> rbind( BS_nl )
}
BS |> View()
i_A <- which(BS[,5] == "10A000020") #資産
i <- grep( "^10A[12]",BS[,5] )
BS[ i_A,2 ] <- BS[ i ,2] |> as.integer() |> sum( na.rm = T )
#
i_C <- which(BS[,5] == "10C130370") #繰越利益剰余金
BS[ i_C,  ]
BS[ i_C,2 ] <- SS[ i_SS + 1 ,2]     #SS:
#
i_C <- which(BS[,5] == "10C000030") #純資産
i <- grep( "^10C[12]",BS[,5] )
BS[ i_C,2 ] <- BS[ i ,2] |> as.numeric() |> sum( na.rm = T )
#
i_B <- which(BS[,5] == "10B000020") #負債
BS[ i_B ,2 ] <- BS[ i_A ,2 ] |> as.integer() -
BS[ i_C ,2 ] |> as.integer()
BS[ i_B ,2 ]
#
i_DE <- which(BS[,5] == "10B200090") #株主、役員又は従業員からの長期借入金
BS[ i_DE , ]
#BS[ i_DE ,2 ] <-  NA #init
i <- grep( "^10B[12]",BS[,5] )
BS[ i ,2 ] |> as.integer() |> sum( na.rm = T )
BS[ i_B ,2 ]
BS[ i_DE ,2 ] <- ( BS[ i_B ,2 ] |> as.integer() ) -
( BS[ i   ,2 ] |> as.integer() |> sum( na.rm = T ) )
BS[ i ,2 ] |> as.integer() |> sum( na.rm = T )
#
i_BC <- which(BS[,5] == "10C000040") #負債純資産
BS[ i_BC, ]
i <- c( i_B ,i_C )
BS[ i_BC,2 ] <- BS[ i ,2] |> as.numeric() |> sum( na.rm = T )
#
f <- "HOT010_3.0_BS_仮"
Write_eTax( BS ,f )
#2025-08-31
# sum( col  9(41) ) =          2,200,395     #col  9 受取配当等の額=  numeric
# sum( col 10(42) ) =                0     #col 10 益金算入=        logical
# sum( col 11(43) ) =          2,200,395     #col 11 益金不算入=      numeric
b08 |> View()
#別表8_3_0.R
f <- b08.sheet()
#別表8_3_0.R
f <- b08.sheet(2025-08-31)
f
#別表8_3_0.R
# f <- b08.sheet(2025-08-31) # "HOB800_13.0_受取配当等の益金不算入"
f <- "HOB800_18.0_受取配当等の益金不算入" #令和7年4月1日以後終了事業年度分
f
#2025-08-31
# sum( col  9(41) ) =          2,200,395     #col  9 受取配当等の額=  numeric
# sum( col 10(42) ) =                0     #col 10 益金算入=        logical
# sum( col 11(43) ) =          2,200,395     #col 11 益金不算入=      numeric
b08 |> View()
Write_eTax( b08 ,f )
#2025-08-31
# sum( col  9(41) ) =          2,200,395     #col  9 受取配当等の額=  numeric
# sum( col 10(42) ) =                0     #col 10 益金算入=        logical
# sum( col 11(43) ) =          2,200,395     #col 11 益金不算入=      numeric
b08 |> View()
b08[,12:19] <- ""  #印刷不可対応 (正)19列 (誤)11列
b08 |> View()
b08[,1]
#別表8_3_0.R
# f <- b08.sheet(2025-08-31) # "HOB800_13.0_受取配当等の益金不算入"
# # 2024-04-06 トラブル報告
# b08_4[,1] #(正)"0801-4" (誤)"0801_01-4"
b08[,1] <- "0801-4"
b08[,1]
b08 |> View()
Write_eTax( b08 ,f )
#留意事項
"https://www.e-tax.nta.go.jp/hojin/gimuka/csv_jyoho1/2025-2/HOB800_18.0.pdf" |>
browseURL()
#⑥有価証券の内訳書_2.R
# 【⑥有価証券の内訳書】から
b08 <- b08_4.ex( b08_4 ,i06_前期 ,i06_当期 )
#2025-08-31
# sum( col  9(41) ) =          2,200,395     #col  9 受取配当等の額=  numeric
# sum( col 10(42) ) =                0     #col 10 益金算入=        logical
# sum( col 11(43) ) =          2,200,395     #col 11 益金不算入=      numeric
b08 |> View()
#別表8_3_0.R
# f <- b08.sheet(2025-08-31) # "HOB800_13.0_受取配当等の益金不算入"
# # 2024-04-06 トラブル報告
# b08_4[,1] #(正)"0801-4" (誤)"0801_01-4"
b08[,1] <- "0801-4"
# b08[,12:19] <- ""  #印刷不可対応 (正)19列 (誤)11列
# b08[,12:19] <- ""  #印刷不可対応 (誤)19列 (正)11列
b08 |> View()
#
f <- "HOB800_18.0_受取配当等の益金不算入" #令和7年4月1日以後終了事業年度分
Write_eTax( b08 ,f )
# b08[,12:19] <- ""  #印刷不可対応 (正)19列 (誤)11列
# b08[,12:19] <- ""  #印刷不可対応 (誤)19列 (正)11列
b08 |> View()
setwd("~/Library/CloudStorage/OneDrive-個人用/Office/eTax/04_別表06(1)_所得税額の控除")
# 2025-09-20(土) csv$
#法人税申告書別表等の標準フォーム検索
"https://www.e-tax.nta.go.jp/hojin/gimuka/beppyou/beppyou.htm" |>
browseURL()
#令和7年4月1日以後終了事業年度分
#設定するファイル名称 HOB800_18.0.csv
#該当箇所
"https://www.e-tax.nta.go.jp/hojin/gimuka/2025/beppyo6_1.pdf" |>
browseURL()
#留意事項
"https://www.e-tax.nta.go.jp/hojin/gimuka/csv_jyoho1/2025-2/HOB016_6.0.pdf" |>
browseURL()
#【e-Taxソフト】CSV形式：別表6(1) 所得税額の控除に関する明細書：を作成する。
#（SBI証券の株式等配当金のお知らせから）
"https://qiita.com/nt1969m/items/df867264d4f014bebf38" |>
browseURL()
#
#b0601 |> View()
b06 |> View()
#
b0601 |> View()
f <- b06.sheet( 決算日 )
f
b0601[,2]
b0601[,2] <- b0601[,2] |> substr( 1 ,15 )
b0601[,2] # 2 銘柄 全角 15 文字以内
f <- b06.sheet( 決算日 )
f
#誤Write_eTax( b06 ,f )   # 2022-09-07 del
Write_eTax( b0601 ,f ) # 2022-09-07 rep
setwd("~/Library/CloudStorage/OneDrive-個人用/Office/eTax/02_財務諸表")
files <- dir(	pattern = "^PL_.*.csv$" ,ignore.case=T )
for( f in files ) {
message( f ,"\t\t" ,f |> file.mtime() )
PL_nl <-
read.table( f
,fileEncoding = "CP932"
,sep=","
,tryLogical = F
,colClasses = c(NA,NA,NA,NA,"character")
)
if( f == files[1]){
PL <- PL_nl
} else {
PL <- PL |> rbind( PL_nl )
}
}
PL |> View()
for( f in files ) {
message( f ,"\t\t" ,f |> file.mtime() )
PL_nl <-
read.table( f
,fileEncoding = "CP932"
,sep=","
,tryLogical = F
,colClasses = c(NA,NA,NA,NA,"character")
)
if( f == files[1]){
PL <- PL_nl
} else {
PL <- PL |> rbind( PL_nl )
}
}
PL |> View()
i_PL <- which( PL[,5] == "10F000010") # 売上総利益又は売上総損失（△）
PL[ i_PL, ]
i_D <- grep( "^10D1",PL[,5] )
PL[ i_D, ]
i_E <- grep( "^10E10",PL[,5] )
PL[ i_E, ]
PL[ i_PL,2 ] <-
PL[ i_D ,2 ] |> as.numeric() |> sum( na.rm = T ) +
PL[ i_E ,2 ] |> as.numeric() |> sum( na.rm = T ) * -1
PL[ i_PL, ]
#
i_PL <- which( PL[,5] == "10E111330") # 販売費及び一般管理費
PL[ i_PL, ]
i <- grep( "^10E20",PL[,5] )
PL[ i, ]
PL[ i_PL,2 ] <- PL[ i ,2 ] |> as.numeric() |> sum( na.rm = T )
PL[ i_PL, ]
#
i_Op <- which( PL[,5] == "10F000110") # 営業利益又は営業損失（△）
PL[ i_Op, ]
i <- grep( "^10E11",PL[,5] )
PL[ i, ]
PL[ i_Op,2 ] <-
PL[ i_D ,2 ] |> as.numeric() |> sum( na.rm = T ) +
PL[ i_E ,2 ] |> as.numeric() |> sum( na.rm = T ) * -1 +
PL[ i ,2 ] |> as.numeric() |> sum( na.rm = T ) * -1
PL[ i_Op, ]
i_P <- which( PL[,5] == "10D200740") # 営業外収益
i <- grep( "^10D200",PL[,5] )
PL[ i, ]
PL[ i_P, ]
PL[ i_P,2 ] <- PL[ i ,2 ] |> as.numeric() |> sum( na.rm = T )
PL[ i_P, ]
#
i_L <- which( PL[,5] == "10E300910") # 営業外費用
PL[ i_L, ]
#i <- grep( "^10E300[08]",PL[,5] )
i <- grep( "^10E300",PL[,5] )
PL[ i, ]
PL[ i_L,2 ] <- PL[ i ,2 ] |> as.numeric() |> sum( na.rm = T )
PL[ i_L, ]
#
i_PL <- which( PL[,5] == "10F000130") # 経常利益又は経常損失（△）
PL[ i_PL, ]
PL[ i_PL,2 ] <-
PL[ i_Op ,2 ] |> as.numeric()  +
PL[ i_P ,2 ]  |> as.numeric()  +
PL[ i_L ,2 ] |> as.numeric() * -1
PL[ i_PL, ]
#
i_Pre <- which( PL[,5] == "10F000150") # 税引前当期純利益又は税引前当期純損失（△）
PL[ i_Pre, ]
PL[ i_Pre,2 ] <- PL[ i_PL,2 ] |> as.integer()
#
i_net <- which( PL[,5] == "10F000160") #当期純利益又は当期純損失（△）
PL[ i_net, ]
i <- grep( "^10F100060|10F100070",PL[,5] )
PL[ i, ]
PL[ i_net,2 ] <- PL[ i_Pre,2 ] |> as.integer() -
( PL[ i,2 ] |> as.integer() |> sum( na.rm = T) )
PL |> View()
#
#f <- paste0( "HOT010_3.0_PL" ,"_仮")
f <- paste0( "HOT010_3.0_PL" ,"_本")
Write_eTax( PL ,f)
files <- dir(	pattern = "^SS_SS.*.csv$" ,ignore.case=T )
#files |> file.info()
#files |> file.mtime()
SS <- matrix(nrow=0,ncol=5)
for( f in files ) {
message( f ,"\t\t",f |> file.mtime() )
SS_nl <-
read.table( f
,fileEncoding = "CP932"
,sep=","
,tryLogical = F
)
SS <- SS |> rbind( SS_nl )
}
SS |> View()
i_SS <- which(SS[,5] == "SS2006") #SS:当期純利益
SS[ i_SS ,]
# i_PL <- which(PL[,5] == "SS2006") #PL:当期純利益
PL[i_net,]
SS[ i_SS,2 ] <- PL[i_net,2]
#
SS[ i_SS + 1 , ]
SS[ i_SS + 1 ,2 ] <-  SS[ i_SS - 1 ,2 ] |> as.integer() +
SS[ i_SS     ,2 ] |> as.integer()
SS |> View()
f <- paste0( "HOT010_3.0_SS" ,"_本")
Write_eTax( SS ,f)
files <- dir(	pattern = "^BS_10.*.csv$" ,ignore.case=T )
BS <- matrix( nrow=0 ,ncol=5 )
for( f in files ) {
message( f ,"\t\t" ,f |> file.mtime() )
BS_nl <- read.table( f
,fileEncoding = "CP932"
,sep=","
,tryLogical = F
)
BS <- BS |> rbind( BS_nl )
}
BS |> View()
i_A <- which(BS[,5] == "10A000020") #資産
i <- grep( "^10A[12]",BS[,5] )
BS[ i_A,2 ] <- BS[ i ,2] |> as.integer() |> sum( na.rm = T )
#
i_C <- which(BS[,5] == "10C130370") #繰越利益剰余金
BS[ i_C,  ]
BS[ i_C,2 ] <- SS[ i_SS + 1 ,2]     #SS:
#
i_C <- which(BS[,5] == "10C000030") #純資産
i <- grep( "^10C[12]",BS[,5] )
BS[ i_C,2 ] <- BS[ i ,2] |> as.numeric() |> sum( na.rm = T )
#
i_B <- which(BS[,5] == "10B000020") #負債
BS[ i_B ,2 ] <- BS[ i_A ,2 ] |> as.integer() -
BS[ i_C ,2 ] |> as.integer()
BS[ i_B ,2 ]
#
i_DE <- which(BS[,5] == "10B200090") #株主、役員又は従業員からの長期借入金
BS[ i_DE , ]
#BS[ i_DE ,2 ] <-  NA #init
i <- grep( "^10B[12]",BS[,5] )
BS[ i ,2 ] |> as.integer() |> sum( na.rm = T )
BS[ i_B ,2 ]
BS[ i_DE ,2 ] <- ( BS[ i_B ,2 ] |> as.integer() ) -
( BS[ i   ,2 ] |> as.integer() |> sum( na.rm = T ) )
BS[ i ,2 ] |> as.integer() |> sum( na.rm = T )
#
i_BC <- which(BS[,5] == "10C000040") #負債純資産
BS[ i_BC, ]
i <- c( i_B ,i_C )
BS[ i_BC,2 ] <- BS[ i ,2] |> as.numeric() |> sum( na.rm = T )
Write_eTax( BS ,f )
f <- "HOT010_3.0_BS_本"
f
Write_eTax( BS ,f )
setwd("~/Library/Mobile Documents/iCloud~com~kappsmart~rcompiler/Documents/office")
tools::showNonASCIIfile
"R/bank_tb.R" |> tools::showNonASCIIfile()
setwd("~/Library/CloudStorage/OneDrive-個人用/Office/B_9900_ゆうちょ銀行")
B_9900 <- read_bank( f="^2025.*.csv" )
setwd("~/Library/CloudStorage/OneDrive-個人用/Office/B_0033_JNB")
B_0033 <- read_bank( f="^2025.*.csv" )
B_0033 |> View()
i06_init
office::ascci
office::ascci_jp
office::ascii_jp
office:ascii_jp
ascii_jp
office::
office:
:
library(office)
office::ascii_jp
"\ue59b\ubde7\ua88e"
cat(stringi::stri_escape_unicode("国税"))
cat(stringi::stri_escape_unicode("税引後"))
cat(stringi::stri_escape_unicode("税引前　※推測"))
B_0033 <- read_bank( f="^2025.*.csv" )
setwd("~/Library/Mobile Documents/iCloud~com~kappsmart~rcompiler/Documents/office")
tools::showNonASCIIfile(f)
tools::showNonASCIIfile("R/bank_tb.R")
setwd("~/Library/CloudStorage/OneDrive-個人用/Office/eTax/01_会計/01_①預貯金")
i01 <- matrix(nrow=0,ncol=8)
for( f in files ) {
message( f )
i01_nl <-
read.table( f
,fileEncoding = "CP932"
,sep=","
)
i01 <- i01 |> rbind( i01_nl )
}
# files <- dir(	pattern = "^[:digit:]" ,ignore.case=T ) # NG ^ doesn't work
files <- dir(	pattern = "^[01]._" ,ignore.case=T )
files
for( f in files ) {
message( f )
i01_nl <-
read.table( f
,fileEncoding = "CP932"
,sep=","
)
i01 <- i01 |> rbind( i01_nl )
}
i01 |> View()
i01 |> View()
